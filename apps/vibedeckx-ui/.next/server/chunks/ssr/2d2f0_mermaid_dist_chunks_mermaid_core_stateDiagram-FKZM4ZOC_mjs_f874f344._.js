module.exports=[30038,a=>{"use strict";var b,c=a.i(71953);a.i(93244),a.i(29535),a.i(14967),a.i(85655),a.i(92115),a.i(10473),a.i(38700),a.i(1540),a.i(64332);var d=a.i(35757),e=a.i(90742),f=a.i(2697);a.i(43066);var g=a.i(55784);a.i(58736);var h=a.i(35660);a.i(53415);var i=a.i(92655),j=a.i(98648),k=a.i(29393),l=(0,f.__name)(a=>a.append("circle").attr("class","start-state").attr("r",(0,e.getConfig2)().state.sizeUnit).attr("cx",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit).attr("cy",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit),"drawStartState"),m=(0,f.__name)(a=>a.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",(0,e.getConfig2)().state.textHeight).attr("class","divider").attr("x2",2*(0,e.getConfig2)().state.textHeight).attr("y1",0).attr("y2",0),"drawDivider"),n=(0,f.__name)((a,b)=>{let c=a.append("text").attr("x",2*(0,e.getConfig2)().state.padding).attr("y",(0,e.getConfig2)().state.textHeight+2*(0,e.getConfig2)().state.padding).attr("font-size",(0,e.getConfig2)().state.fontSize).attr("class","state-title").text(b.id),d=c.node().getBBox();return a.insert("rect",":first-child").attr("x",(0,e.getConfig2)().state.padding).attr("y",(0,e.getConfig2)().state.padding).attr("width",d.width+2*(0,e.getConfig2)().state.padding).attr("height",d.height+2*(0,e.getConfig2)().state.padding).attr("rx",(0,e.getConfig2)().state.radius),c},"drawSimpleState"),o=(0,f.__name)((a,b)=>{let c=(0,f.__name)(function(a,b,c){let d=a.append("tspan").attr("x",2*(0,e.getConfig2)().state.padding).text(b);c||d.attr("dy",(0,e.getConfig2)().state.textHeight)},"addTspan"),d=a.append("text").attr("x",2*(0,e.getConfig2)().state.padding).attr("y",(0,e.getConfig2)().state.textHeight+1.3*(0,e.getConfig2)().state.padding).attr("font-size",(0,e.getConfig2)().state.fontSize).attr("class","state-title").text(b.descriptions[0]).node().getBBox(),g=d.height,h=a.append("text").attr("x",(0,e.getConfig2)().state.padding).attr("y",g+.4*(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.dividerMargin+(0,e.getConfig2)().state.textHeight).attr("class","state-description"),i=!0,j=!0;b.descriptions.forEach(function(a){i||(c(h,a,j),j=!1),i=!1});let k=a.append("line").attr("x1",(0,e.getConfig2)().state.padding).attr("y1",(0,e.getConfig2)().state.padding+g+(0,e.getConfig2)().state.dividerMargin/2).attr("y2",(0,e.getConfig2)().state.padding+g+(0,e.getConfig2)().state.dividerMargin/2).attr("class","descr-divider"),l=h.node().getBBox(),m=Math.max(l.width,d.width);return k.attr("x2",m+3*(0,e.getConfig2)().state.padding),a.insert("rect",":first-child").attr("x",(0,e.getConfig2)().state.padding).attr("y",(0,e.getConfig2)().state.padding).attr("width",m+2*(0,e.getConfig2)().state.padding).attr("height",l.height+g+2*(0,e.getConfig2)().state.padding).attr("rx",(0,e.getConfig2)().state.radius),a},"drawDescrState"),p=(0,f.__name)((a,b,c)=>{let d,f=(0,e.getConfig2)().state.padding,g=2*(0,e.getConfig2)().state.padding,h=a.node().getBBox(),i=h.width,j=h.x,k=a.append("text").attr("x",0).attr("y",(0,e.getConfig2)().state.titleShift).attr("font-size",(0,e.getConfig2)().state.fontSize).attr("class","state-title").text(b.id),l=k.node().getBBox().width+g,m=Math.max(l,i);m===i&&(m+=g);let n=a.node().getBBox();b.doc,d=j-f,l>i&&(d=(i-m)/2+f),Math.abs(j-n.x)<f&&l>i&&(d=j-(l-i)/2);let o=1-(0,e.getConfig2)().state.textHeight;return a.insert("rect",":first-child").attr("x",d).attr("y",o).attr("class",c?"alt-composit":"composit").attr("width",m).attr("height",n.height+(0,e.getConfig2)().state.textHeight+(0,e.getConfig2)().state.titleShift+1).attr("rx","0"),k.attr("x",d+f),l<=i&&k.attr("x",j+(m-g)/2-l/2+f),a.insert("rect",":first-child").attr("x",d).attr("y",(0,e.getConfig2)().state.titleShift-(0,e.getConfig2)().state.textHeight-(0,e.getConfig2)().state.padding).attr("width",m).attr("height",3*(0,e.getConfig2)().state.textHeight).attr("rx",(0,e.getConfig2)().state.radius),a.insert("rect",":first-child").attr("x",d).attr("y",(0,e.getConfig2)().state.titleShift-(0,e.getConfig2)().state.textHeight-(0,e.getConfig2)().state.padding).attr("width",m).attr("height",n.height+3+2*(0,e.getConfig2)().state.textHeight).attr("rx",(0,e.getConfig2)().state.radius),a},"addTitleAndBox"),q=(0,f.__name)(a=>(a.append("circle").attr("class","end-state-outer").attr("r",(0,e.getConfig2)().state.sizeUnit+(0,e.getConfig2)().state.miniPadding).attr("cx",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit+(0,e.getConfig2)().state.miniPadding).attr("cy",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit+(0,e.getConfig2)().state.miniPadding),a.append("circle").attr("class","end-state-inner").attr("r",(0,e.getConfig2)().state.sizeUnit).attr("cx",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit+2).attr("cy",(0,e.getConfig2)().state.padding+(0,e.getConfig2)().state.sizeUnit+2)),"drawEndState"),r=(0,f.__name)((a,b)=>{let c=(0,e.getConfig2)().state.forkWidth,d=(0,e.getConfig2)().state.forkHeight;if(b.parentId){let a=c;c=d,d=a}return a.append("rect").style("stroke","black").style("fill","black").attr("width",c).attr("height",d).attr("x",(0,e.getConfig2)().state.padding).attr("y",(0,e.getConfig2)().state.padding)},"drawForkJoinState"),s=(0,f.__name)((a,b,c,d)=>{let f=0,g=d.append("text");g.style("text-anchor","start"),g.attr("class","noteText");let h=a.replace(/\r\n/g,"<br/>"),i=(h=h.replace(/\n/g,"<br/>")).split(e.common_default.lineBreakRegex),j=1.25*(0,e.getConfig2)().state.noteMargin;for(let a of i){let d=a.trim();if(d.length>0){let a=g.append("tspan");a.text(d),0===j&&(j+=a.node().getBBox().height),f+=j,a.attr("x",b+(0,e.getConfig2)().state.noteMargin),a.attr("y",c+f+1.25*(0,e.getConfig2)().state.noteMargin)}}return{textWidth:g.node().getBBox().width,textHeight:f}},"_drawLongText"),t=(0,f.__name)((a,b)=>{b.attr("class","state-note");let c=b.append("rect").attr("x",0).attr("y",(0,e.getConfig2)().state.padding),{textWidth:d,textHeight:f}=s(a,0,0,b.append("g"));return c.attr("height",f+2*(0,e.getConfig2)().state.noteMargin),c.attr("width",d+2*(0,e.getConfig2)().state.noteMargin),c},"drawNote"),u=(0,f.__name)(function(a,b){let c=b.id,d={id:c,label:b.id,width:0,height:0},f=a.append("g").attr("id",c).attr("class","stateGroup");"start"===b.type&&l(f),"end"===b.type&&q(f),("fork"===b.type||"join"===b.type)&&r(f,b),"note"===b.type&&t(b.note.text,f),"divider"===b.type&&m(f),"default"===b.type&&0===b.descriptions.length&&n(f,b),"default"===b.type&&b.descriptions.length>0&&o(f,b);let g=f.node().getBBox();return d.width=g.width+2*(0,e.getConfig2)().state.padding,d.height=g.height+2*(0,e.getConfig2)().state.padding,d},"drawState"),v=0,w=(0,f.__name)(function(a,b,g){let h=(0,f.__name)(function(a){switch(a){case c.StateDB.relationType.AGGREGATION:return"aggregation";case c.StateDB.relationType.EXTENSION:return"extension";case c.StateDB.relationType.COMPOSITION:return"composition";case c.StateDB.relationType.DEPENDENCY:return"dependency"}},"getRelationType");b.points=b.points.filter(a=>!Number.isNaN(a.y));let i=b.points,l=(0,j.line)().x(function(a){return a.x}).y(function(a){return a.y}).curve(k.curveBasis),m=a.append("path").attr("d",l(i)).attr("id","edge"+v).attr("class","transition"),n="";if((0,e.getConfig2)().state.arrowMarkerAbsolute&&(n=(0,e.getUrl)(!0)),m.attr("marker-end","url("+n+"#"+h(c.StateDB.relationType.DEPENDENCY)+"End)"),void 0!==g.title){let c=a.append("g").attr("class","stateLabel"),{x:h,y:i}=d.utils_default.calcLabelPosition(b.points),j=e.common_default.getRows(g.title),k=0,l=[],m=0,n=0;for(let a=0;a<=j.length;a++){let b=c.append("text").attr("text-anchor","middle").text(j[a]).attr("x",h).attr("y",i+k),d=b.node().getBBox();m=Math.max(m,d.width),n=Math.min(n,d.x),f.log.info(d.x,h,i+k),0===k&&(k=b.node().getBBox().height,f.log.info("Title height",k,i)),l.push(b)}let o=k*j.length;if(j.length>1){let a=(j.length-1)*k*.5;l.forEach((b,c)=>b.attr("y",i+c*k-a)),o=k*j.length}let p=c.node().getBBox();c.insert("rect",":first-child").attr("class","box").attr("x",h-m/2-(0,e.getConfig2)().state.padding/2).attr("y",i-o/2-(0,e.getConfig2)().state.padding/2-3.5).attr("width",m+(0,e.getConfig2)().state.padding).attr("height",o+(0,e.getConfig2)().state.padding),f.log.info(p)}v++},"drawEdge"),x={},y=(0,f.__name)(function(){},"setConf"),z=(0,f.__name)(function(a){a.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"insertMarkers"),A=(0,f.__name)(function(a,c,d,h){let i;b=(0,e.getConfig2)().state;let j=(0,e.getConfig2)().securityLevel;"sandbox"===j&&(i=(0,g.select)("#i"+c));let k="sandbox"===j?(0,g.select)(i.nodes()[0].contentDocument.body):(0,g.select)("body"),l="sandbox"===j?i.nodes()[0].contentDocument:document;f.log.debug("Rendering diagram "+a);let m=k.select(`[id='${c}']`);z(m),C(h.db.getRootDoc(),m,void 0,!1,k,l,h);let n=b.padding,o=m.node().getBBox(),p=o.width+2*n,q=o.height+2*n;(0,e.configureSvgSize)(m,q,1.75*p,b.useMaxWidth),m.attr("viewBox",`${o.x-b.padding}  ${o.y-b.padding} `+p+" "+q)},"draw"),B=(0,f.__name)(a=>a?a.length*b.fontSizeFactor:1,"getLabelWidth"),C=(0,f.__name)((a,c,d,g,j,k,l)=>{let m,n=new i.Graph({compound:!0,multigraph:!0}),o=!0;for(m=0;m<a.length;m++)if("relation"===a[m].stmt){o=!1;break}d?n.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:o?1:b.edgeLengthFactor,nodeSep:o?1:50,isMultiGraph:!0}):n.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:o?1:b.edgeLengthFactor,nodeSep:o?1:50,ranker:"tight-tree",isMultiGraph:!0}),n.setDefaultEdgeLabel(function(){return{}});let q=l.db.getStates(),r=l.db.getRelations();for(let a of Object.keys(q)){let e,f=q[a];if(d&&(f.parentId=d),f.doc){let a=c.append("g").attr("id",f.id).attr("class","stateGroup");e=C(f.doc,a,f.id,!g,j,k,l);{let c=(a=p(a,f,g)).node().getBBox();e.width=c.width,e.height=c.height+b.padding/2,x[f.id]={y:b.compositTitleSize}}}else e=u(c,f,n);if(f.note){let a=u(c,{descriptions:[],id:f.id+"-note",note:f.note,type:"note"},n);"left of"===f.note.position?(n.setNode(e.id+"-note",a),n.setNode(e.id,e)):(n.setNode(e.id,e),n.setNode(e.id+"-note",a)),n.setParent(e.id,e.id+"-group"),n.setParent(e.id+"-note",e.id+"-group")}else n.setNode(e.id,e)}f.log.debug("Count=",n.nodeCount(),n);let s=0;r.forEach(function(a){s++,f.log.debug("Setting edge",a),n.setEdge(a.id1,a.id2,{relation:a,width:B(a.title),height:b.labelHeight*e.common_default.getRows(a.title).length,labelpos:"c"},"id"+s)}),(0,h.layout)(n),f.log.debug("Graph after layout",n.nodes());let t=c.node();n.nodes().forEach(function(a){void 0!==a&&void 0!==n.node(a)?(f.log.warn("Node "+a+": "+JSON.stringify(n.node(a))),j.select("#"+t.id+" #"+a).attr("transform","translate("+(n.node(a).x-n.node(a).width/2)+","+(n.node(a).y+(x[a]?x[a].y:0)-n.node(a).height/2)+" )"),j.select("#"+t.id+" #"+a).attr("data-x-shift",n.node(a).x-n.node(a).width/2),k.querySelectorAll("#"+t.id+" #"+a+" .divider").forEach(a=>{let b=a.parentElement,c=0,d=0;b&&(b.parentElement&&(c=b.parentElement.getBBox().width),Number.isNaN(d=parseInt(b.getAttribute("data-x-shift"),10))&&(d=0)),a.setAttribute("x1",0-d+8),a.setAttribute("x2",c-d-8)})):f.log.debug("No Node "+a+": "+JSON.stringify(n.node(a)))});let v=t.getBBox();n.edges().forEach(function(a){void 0!==a&&void 0!==n.edge(a)&&(f.log.debug("Edge "+a.v+" -> "+a.w+": "+JSON.stringify(n.edge(a))),w(c,n.edge(a),n.edge(a).relation))});let y={id:d||"root",label:d||"root",width:0,height:0};return y.width=(v=t.getBBox()).width+2*b.padding,y.height=v.height+2*b.padding,f.log.debug("Doc rendered",y,n),y},"renderDoc"),D={parser:c.stateDiagram_default,get db(){return new c.StateDB(1)},renderer:{setConf:y,draw:A},styles:c.styles_default,init:(0,f.__name)(a=>{a.state||(a.state={}),a.state.arrowMarkerAbsolute=a.arrowMarkerAbsolute},"init")};a.s(["diagram",()=>D])}];

//# sourceMappingURL=2d2f0_mermaid_dist_chunks_mermaid_core_stateDiagram-FKZM4ZOC_mjs_f874f344._.js.map